Training:  dbsr  sac_burst4_1step8_multigpu
Training:  dbsr  sac_burst4_1step8_multigpu
Training:  dbsr  sac_burst4_1step8_multigpu
Training:  dbsr  sac_burst4_1step8_multigpu
Training:  dbsr  sac_burst4_1step8_multigpu
Training:  dbsr  sac_burst4_1step8_multigpu
Training:  dbsr  sac_burst4_1step8_multigpu
Training:  dbsr  sac_burst4_1step8_multigpu
train dataset length:  30
val dataset length:  18
Cannot load SpatialCorrelationSampler moduleCannot load SpatialCorrelationSampler module

WARNING: Keyword argument "backbone_pretrained" not found when loading network. It was ignored.
WARNING: Keyword argument "backbone_pretrained" not found when loading network. It was ignored.
Cannot load SpatialCorrelationSampler moduleCannot load SpatialCorrelationSampler module

Cannot load SpatialCorrelationSampler module
Cannot load SpatialCorrelationSampler module
WARNING: Keyword argument "backbone_pretrained" not found when loading network. It was ignored.WARNING: Keyword argument "backbone_pretrained" not found when loading network. It was ignored.

WARNING: Keyword argument "backbone_pretrained" not found when loading network. It was ignored.
WARNING: Keyword argument "backbone_pretrained" not found when loading network. It was ignored.
Cannot load SpatialCorrelationSampler module
WARNING: Keyword argument "backbone_pretrained" not found when loading network. It was ignored.
Cannot load SpatialCorrelationSampler module
WARNING: Keyword argument "backbone_pretrained" not found when loading network. It was ignored.
Starting saving checkpoint!!!!!!
what is now processing True
Completed!!!!!!!!!!
Training crashed at epoch -1
Traceback for the error!
Training crashed at epoch -1
Traceback for the error!
Training crashed at epoch -1
Traceback for the error!
Traceback (most recent call last):
  File "/home/user/zheng/DBSR/trainers/base_agent_trainer_v3.py", line 84, in train
    self.train_sac(max_epochs, replay_buffer)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 464, in train_sac
    self.train_off_policy_agent(self.loaders, max_epochs, replay_buffer, minimal_size=self.minimal_size)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 937, in train_off_policy_agent
    avg_loss, avg_return, avg_improvement = self.train_one_epoch(loader, replay_buffer, minimal_size, epoch=epoch, loader_attributes=self.loader_attributes[i_loader])
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 849, in train_one_epoch
    pred, _ = self.sr_net(next_state.clone())
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/deeprepnet.py", line 69, in forward
    y_pred = self.hr_decoder(lr_enc)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/decoders.py", line 58, in forward
    out = self.upsample_layer(out)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/layers/upsampling.py", line 64, in forward
    out = F.conv2d(out, self.gauss_kernel.to(out.device), padding=(gauss_ksz - 1) // 2)
KeyboardInterrupt

Restarting training from last epoch ...
Traceback (most recent call last):
  File "/home/user/zheng/DBSR/trainers/base_agent_trainer_v3.py", line 84, in train
    self.train_sac(max_epochs, replay_buffer)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 464, in train_sac
    self.train_off_policy_agent(self.loaders, max_epochs, replay_buffer, minimal_size=self.minimal_size)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 937, in train_off_policy_agent
    avg_loss, avg_return, avg_improvement = self.train_one_epoch(loader, replay_buffer, minimal_size, epoch=epoch, loader_attributes=self.loader_attributes[i_loader])
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 849, in train_one_epoch
    pred, _ = self.sr_net(next_state.clone())
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/deeprepnet.py", line 69, in forward
    y_pred = self.hr_decoder(lr_enc)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/decoders.py", line 58, in forward
    out = self.upsample_layer(out)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/layers/upsampling.py", line 64, in forward
    out = F.conv2d(out, self.gauss_kernel.to(out.device), padding=(gauss_ksz - 1) // 2)
KeyboardInterrupt

Restarting training from last epoch ...
Traceback (most recent call last):
  File "/home/user/zheng/DBSR/trainers/base_agent_trainer_v3.py", line 84, in train
    self.train_sac(max_epochs, replay_buffer)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 464, in train_sac
    self.train_off_policy_agent(self.loaders, max_epochs, replay_buffer, minimal_size=self.minimal_size)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 937, in train_off_policy_agent
    avg_loss, avg_return, avg_improvement = self.train_one_epoch(loader, replay_buffer, minimal_size, epoch=epoch, loader_attributes=self.loader_attributes[i_loader])
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 849, in train_one_epoch
    pred, _ = self.sr_net(next_state.clone())
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/deeprepnet.py", line 69, in forward
    y_pred = self.hr_decoder(lr_enc)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/decoders.py", line 58, in forward
    out = self.upsample_layer(out)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/layers/upsampling.py", line 64, in forward
    out = F.conv2d(out, self.gauss_kernel.to(out.device), padding=(gauss_ksz - 1) // 2)
KeyboardInterrupt
Finished training!
Finished training!

Training crashed at epoch -1
Traceback for the error!
Traceback (most recent call last):
  File "/home/user/zheng/DBSR/trainers/base_agent_trainer_v3.py", line 84, in train
    self.train_sac(max_epochs, replay_buffer)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 464, in train_sac
    self.train_off_policy_agent(self.loaders, max_epochs, replay_buffer, minimal_size=self.minimal_size)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 937, in train_off_policy_agent
    avg_loss, avg_return, avg_improvement = self.train_one_epoch(loader, replay_buffer, minimal_size, epoch=epoch, loader_attributes=self.loader_attributes[i_loader])
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 849, in train_one_epoch
    pred, _ = self.sr_net(next_state.clone())
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/deeprepnet.py", line 61, in forward
    offsets, offsets_aux = self.alignment_net(im)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/alignment.py", line 56, in forward
    offsets = self.alignment_net(im_ref.view(-1, *im_ref.shape[-3:]), im_oth.view(-1, *im_oth.shape[-3:]))
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/alignment/pwcnet.py", line 273, in forward
    flow = self.net(target_img_re, source_img_re)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/alignment/pwcnet.py", line 227, in forward
    objEstimate = self.netFou(tenFirst[-3], tenSecond[-3], objEstimate)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/alignment/pwcnet.py", line 179, in forward
    tenFlow = self.netSix(tenFeat)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 457, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 453, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
KeyboardInterrupt

Restarting training from last epoch ...
Finished training!
Restarting training from last epoch ...
Finished training!
Training crashed at epoch -1
Traceback for the error!
Traceback (most recent call last):
  File "/home/user/zheng/DBSR/trainers/base_agent_trainer_v3.py", line 84, in train
    self.train_sac(max_epochs, replay_buffer)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 464, in train_sac
    self.train_off_policy_agent(self.loaders, max_epochs, replay_buffer, minimal_size=self.minimal_size)
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 937, in train_off_policy_agent
    avg_loss, avg_return, avg_improvement = self.train_one_epoch(loader, replay_buffer, minimal_size, epoch=epoch, loader_attributes=self.loader_attributes[i_loader])
  File "/home/user/zheng/DBSR/trainers/sac_agent.py", line 849, in train_one_epoch
    pred, _ = self.sr_net(next_state.clone())
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1008, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 969, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/deeprepnet.py", line 61, in forward
    offsets, offsets_aux = self.alignment_net(im)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/deeprep/alignment.py", line 56, in forward
    offsets = self.alignment_net(im_ref.view(-1, *im_ref.shape[-3:]), im_oth.view(-1, *im_oth.shape[-3:]))
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/alignment/pwcnet.py", line 273, in forward
    flow = self.net(target_img_re, source_img_re)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/alignment/pwcnet.py", line 225, in forward
    objEstimate = self.netSix(tenFirst[-1], tenSecond[-1], None)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/zheng/DBSR/models/alignment/pwcnet.py", line 174, in forward
    tenFeat = torch.cat([ self.netTwo(tenFeat), tenFeat ], 1)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/modules/activation.py", line 772, in forward
    return F.leaky_relu(input, self.negative_slope, self.inplace)
  File "/home/user/miniconda3/envs/z/lib/python3.8/site-packages/torch/nn/functional.py", line 1633, in leaky_relu
    result = torch._C._nn.leaky_relu(input, negative_slope)
KeyboardInterrupt

Restarting training from last epoch ...
Finished training!
